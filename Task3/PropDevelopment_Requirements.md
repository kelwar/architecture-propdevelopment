# Требования к безопасности

- Данные между мобильным приложением и АПИ домофона и АПИ шлагбаума должны передаваться только в шифрованном виде (HTTPS).
- Контракт приложения с АПИ домофона должен содержать только уникальный идентификатор квартиры, основанный на её адресе, уникальный идентификатор пользователя и биометрию (при регистрации). Идентификаторы квартир могут быть предоставлены через запрос к АПИ домофона с указанием номеров квартир.
- Контракт приложения с АПИ шлагбаума должен содержать только уникальный идентификатор шлагбаума, уникальный идентификатор пользователя и номер машины (при регистрации). Идентификатор шлагбаума может быть предоставлен через запрос к АПИ шлагбаума.
- Никакие персональные данные кроме биометрии, номеров квартир и номеров машин не участвуют во взаимодействии с АПИ домофона и шлагбаума.

# Протоколы аутентификации и авторизации

- Аутентификация по HTTPS через POST-запрос.
- Авторизация должна быть организовано по RBAC. Пользователи домофона получают доступ к управлению домофоном. Пользователи шлагбаума получают доступ к управлению шлагбаумом.

# Организация взаимодействия

## АПИ домофона

### Регистрация

- Пользователь добавляет квартиру в приложении - POST-запрос к АПИ передаёт ID пользователя и ID квартиры для их связывания.
- Пользователь добавляет биометрию в приложение - POST-запрос к АПИ передаёт ID пользователя и биометрию для их связывания.

### Использование

- Пользователь с зарегистрированной биометрией подходит к домофону - домофон открывается, ПО домофона передаёт сведения об этом в мобильное приложение (для сохранения истории).
- Пользователь набирает номер квартиры на домофоне - ПО домофона находит зарегистрированные ID пользователей и передаёт сигнал в моб. приложения по этим ID для осуществления вызова.
- Пользователь принимает звонок в моб. приложении - происходит запрос к АПИ на установление аудио и видеосвязи.
- Пользователь жмёт кнопку открытия в моб. приложении - отправляется POST-запрос на открытие, содержащий ID пользователя и ID квартиры.

## АПИ шлагбаума

### Регистрация

- Пользователь добавляет шлагбаум в приложении - POST-запрос к АПИ передаёт ID пользователя и ID шлагбаума для их связывания.
- Пользователь добавляет номер машины в приложение - POST-запрос к АПИ передаёт ID пользователя и номер машины для их связывания.

### Использование

- Пользователь с зарегистрированным номером машины подъезжает к шлагбауму - шлагбаум открывается, ПО шлагбаума передаёт сведения об этом в мобильное приложение (для сохранения истории).
- Пользователь жмёт кнопку открытия в моб. приложении - отправляется POST-запрос на открытие, содержащий ID пользователя и ID шлагбаума.
